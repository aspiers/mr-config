# -*- mode: sh -*-

[$HOME/.GIT/adamspiers.org/ai-config]
checkout = git_clone_my_repo
remotes = auto_remotes
stowable = true

[$HOME/.GIT/3rd-party/opencode]
checkout = github_clone
remotes = auto_remotes
stowable = true
lib =
    set_git_origin_user sst
fixups =
    npm install -g bun
    bun install
    script=~/bin/oc
    cat <<EOF >$script
    #!/bin/bash
    # Auto-generated by mrf $MR_NAME at `date`

    /home/adam/.nvm/versions/node/v20.19.3/bin/bun run \
        $MR_REPO/packages/opencode/src/index.ts "\$@"
    EOF
    chmod +x $script

[$HOME/.GIT/3rd-party/gemini-cli]
checkout = github_clone
remotes = auto_remotes
lib =
    set_git_origin_user google-gemini
    # Needs to be one of the emails configured in my Google account
    # so that Google's CLA signing process works.
    set_email github@adamspiers.org
fixups =
    source ~/.nvm/nvm.sh
    nvm use 22
    npm install
    export GEMINI_SANDBOX=docker
    npm run build:all
    script=~/bin/gm
    node=`nvm which 22`
    cat <<EOF >$script
    #!/bin/bash
    # Auto-generated by mrf $MR_NAME at `date`

    export GEMINI_SANDBOX=docker
    $node "$MR_REPO/packages/cli" "\$@"
    EOF
    chmod +x $script
