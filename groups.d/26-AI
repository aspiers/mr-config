# -*- mode: sh -*-

[$HOME/.GIT/3rd-party/opencode]
checkout = github_clone
remotes = auto_remotes
stowable = true
lib =
    set_git_origin_user sst
fixups =
    npm install -g bun
    bun install
    cat <<EOF >~/bin/opencode
    #!/bin/bash
    # Auto-generated by mrf $MR_NAME at `date`

    cd "$MR_REPO"
    bun run packages/opencode/src/index.ts "\$@"
    EOF
    chmod +x ~/bin/opencode

[$HOME/.GIT/3rd-party/gemini-cli]
checkout = github_clone
remotes = auto_remotes
stowable = true
lib =
    set_git_origin_user google-gemini
fixups =
    npm install
    export GEMINI_SANDBOX=docker
    npm run build:all
    script=~/bin/gm
    cat <<EOF >$script
    #!/bin/bash
    # Auto-generated by mrf $MR_NAME at `date`

    export GEMINI_SANDBOX=docker
    node "$MR_REPO/packages/cli" "\$@"
    EOF
    chmod +x $script
