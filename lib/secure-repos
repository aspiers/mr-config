# -*- mode: sh -*-

lib =
    confidential_repo () {
        if [ -n "$MR_CONFIDENTIAL_REPO" ]; then
            debug_skippers "! Repo manually set as confidential via \$MR_CONFIDENTIAL_REPO"
            return 0
        fi
        #
        check_repo_name
        case "$MR_NAME" in
            *.sec|*novell*)
                debug_skippers "! Repo auto-detected as confidential"
                return 0
                ;;
            *)
                debug_skippers ". Repo is not confidential"
                return 1
                ;;
        esac
    }

fixups =
    if confidential_repo; then
        chmod go-rwx -R "$MR_REPO"
    fi
