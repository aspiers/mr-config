# -*- mode: sh -*-

savannah_ro_remote () {
    git_add_remote savannah `savannah_ro_url`
}

savannah_rw_remote () {
    git_add_remote savannah `savannah_rw_url`
}

github_remote () {
    git_add_remote github `github_url`
}

gitorious_remote () {
    git_add_remote gitorious `gitorious_url`
}

my_upstream_remote () {
    git_add_remote adamspiers.org `my_upstream_url`
}

moosehall_remotes () {
    if not_moosehall; then
        return 0
    fi
    repo="${MR_REPO#$HOME/}"
    # Note: uses URL rewriting so we can decide independently
    # whether to fetch over wired/wireless or even ADSL.
    git_add_remotes "
        atlantic REMOTE:$repo
        southern REMOTE:$repo
        adriatic REMOTE:$repo
        pacific  REMOTE:$repo
        indian   REMOTE:$repo
        mc       mediacentre:$repo mediacentre
    "
}

public_repo_remotes () {
    moosehall_remotes && my_upstream_remote && github_remote
}

private_repo_remotes () {
    moosehall_remotes && my_upstream_remote
}

work_remotes () {
    repo="${MR_REPO#$HOME/}"
    my_upstream_remote
    git_add_remotes "
        atlantic  REMOTE:$repo
        southern  REMOTE:$repo
        pacific   REMOTE:$repo
        indian    REMOTE:$repo
    "
}

auto_remotes () {
    if work_repo; then
        work_remotes
        if ! confidential_repo; then
            my_upstream_remote
            github_remote
        fi
    elif confidential_repo; then
        private_repo_remotes
    else
        public_repo_remotes
    fi
}
